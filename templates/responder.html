{% extends "base.html" %}
{% block content %}
<div class="module">
    <h2>ğŸ“ Responder Preguntas</h2>

    {% if not periodo_abierto %}
        <div class="alert-warning">
            âš ï¸ No hay un periodo abierto. No es posible responder preguntas.
        </div>
    {% else %}
        <div class="alert-info">
            ğŸ“… Periodo abierto: <b>{{ periodo.mes }} / {{ periodo.aÃ±o }}</b>
        </div>

        {% if preguntas %}
        <form method="POST">
            <table>
                <tr>
                    <th>ID</th>
                    <th>Pregunta</th>
                    <th>Tipo</th>
                    <th>Presupuesto</th>
                    <th>Unidad</th>
                    <th>Afecta Presupuesto</th>
                    <th>Respuesta</th>
                </tr>
                {% for p in preguntas %}
                <tr>
                    <td>{{ p.id }}</td>
                    <td style="white-space:pre-wrap;max-width:380px;">{{ p.texto }}</td>
                    <td>{{ p.tipo }}</td>
                    <td>{{ p.presupuesto }}</td>
                    <td>{{ p.unidad }}</td>
                    <td>{{ 'SÃ­' if p.afecta_presupuesto else 'No' }}</td>

                    {% if p.respuesta %}
                        <!-- Mostrar respuesta bloqueada -->
                        <td>
                            <input type="text" value="{{ p.respuesta }}" readonly style="background:#eee;">
                            <span style="color:green;">âœ… Enviada</span>
                        </td>
                    {% else %}
                        <!-- Campo editable -->
                        <td>
                            <input type="text" name="pregunta_{{ p.id }}" placeholder="Escribe tu respuesta..." required>
                        </td>
                    {% endif %}
                </tr>
                {% endfor %}
            </table>

            <br>
            <button type="submit" style="padding:10px 20px; background:#f97316; color:white; border:none; border-radius:6px; cursor:pointer;">
                ğŸ’¾ Guardar todas las respuestas
            </button>
        </form>
        {% else %}
            <div class="alert-warning">âš ï¸ No hay preguntas asignadas a este usuario.</div>
        {% endif %}
    {% endif %}
</div>
{% endblock %}
